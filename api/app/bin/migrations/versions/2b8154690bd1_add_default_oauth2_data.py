"""Add default OAuth2 data

Revision ID: 2b8154690bd1
Revises: 4a5fa1bd74f1
Create Date: 2015-10-15 21:59:03.445441

"""

# revision identifiers, used by Alembic.
revision = '2b8154690bd1'
down_revision = '234863d8225e'

from alembic import op
import string, random
from sqlalchemy.sql import table, column
from sqlalchemy import String, Text, Boolean


def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    client_table = table('client',
                         column('client_id', String(40)),
                         column('client_secret', String(55)),
                         column('_redirect_uris', Text),
                         column('is_confidential', Boolean)
                         )

    client_id = ''.join(random.choice(string.ascii_uppercase) for i in range(40))
    client_secret = ''.join(random.choice(string.ascii_uppercase) for i in range(55))

    op.bulk_insert(client_table,
                   [
                       {
                           'client_id': client_id,
                           'client_secret': client_secret,
                           '_redirect_uris': 'application/authorized',
                           'is_confidential': 1
                       }
                   ])

    from colorama import Fore
    bold = '\033[1m'
    end_bold = '\033[0m'
    print '* Generated: \n - {5}Client ID:{6} {4}{2}{0}{3}{6} \n - {5}Client Secret:{6} {4}{2}{1}{3}{6}'.format(
        client_id,
        client_secret,
        bold,  # {2}
        end_bold,  # {3}
        Fore.GREEN,  # {4}
        Fore.YELLOW,  # {5}
        Fore.RESET  # {6)
    )
    ### end Alembic commands ###


def downgrade():
    grant_table = table('grant')
    op.execute(grant_table.delete())

    grant_table = table('token')
    op.execute(grant_table.delete())

    ### commands auto generated by Alembic - please adjust! ###
    client_table = table('client',
                         column('client_id', String(40)),
                         column('client_secret', String(55)))

    op.execute(client_table.delete())
    ### end Alembic commands ###
